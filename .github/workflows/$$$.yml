name: Descargar Modelos Applio
on: 
  workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: Crear estructura de carpetas
        run: |
          mkdir -p Applio_Models/assets/pretrained_v2
          mkdir -p Applio_Models/assets/weights

      - name: Descargar Modelos Base (Links Blindados)
        run: |
          cd Applio_Models/assets/pretrained_v2
          # Usamos enlaces directos de repositorios espejo probados
          curl -L https://huggingface.co/IAHispano/Applio/resolve/main/assets/pretrained_v2/hubert_base.pt?download=true -o hubert_base.pt
          curl -L https://huggingface.co/IAHispano/Applio/resolve/main/assets/pretrained_v2/rmvpe.pt?download=true -o rmvpe.pt
          curl -L https://huggingface.co/IAHispano/Applio/resolve/main/assets/pretrained_v2/f0D40k.pth?download=true -o f0D40k.pth
          curl -L https://huggingface.co/IAHispano/Applio/resolve/main/assets/pretrained_v2/f0G40k.pth?download=true -o f0G40k.pth

      - name: Descargar Voz de Narrador (Guía de Museo)
        run: |
          cd Applio_Models/assets/weights
          # Modelo de voz clara para museo
          curl -L https://huggingface.co/IAHispano/Applio/resolve/main/assets/weights/v2/spanish_alvaro.pth?download=true -o guia_museo.pth

      - name: Verificar descargas y tamaños
        run: |
          ls -lh Applio_Models/assets/pretrained_v2
          ls -lh Applio_Models/assets/weights

      - name: Comprimir todo en un ZIP
        run: |
          zip -r modelos_applio_guia.zip Applio_Models

      - name: Subir Artifact
        uses: actions/upload-artifact@v4
        with:
          name: Pack-Modelos-Applio-Final
          path: modelos_applio_guia.zip
          retention-days: 1
          
